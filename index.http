@jwt_token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2ODJiNjYwOWE3YTY4MzQ4NGM0NWRhNmMiLCJyb2xlIjpbInVzZXIiXSwiaWF0IjoxNzQ3Njc0NjYwLCJleHAiOjE3NDc3MTA2NjB9.Oi_AeoPrr7BTrBMFrPANq_lzehDROUOsn-_aHYIEdGE
@user_id = 682b6609a7a683484c45da6c
@client_id = 682b6643a7a683484c45da79
@project_id = 682b667aa7a683484c45da92
@deliverynote_id = 682b82c4c04b5e30df5cefb9

###
POST http://localhost:5000/auth/register
Content-Type: application/json

{
    "email": "enriquerodridel@gmail.com",
    "password": "1234asdf"
}

###
PUT http://localhost:5000/auth/verify
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
    "code": "567224"
}

###
POST http://localhost:5000/auth/login
Content-Type: application/json

{
    "email": "enriquerodridel@gmail.com",
    "password": "1234asdf"
}

###
PATCH http://localhost:5000/users
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
    "name": "test3",
    "surnames": "test3Surname",
    "nif": "12345678Z"
}

###
PATCH http://localhost:5000/users/company
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "company": {
    "name": "Servitop, SL.",
    "cif": "BXXXXXXXX",
    "street": "Carlos V",
    "number": 22,
    "postal": 28936,
    "city": "Móstoles",
    "province": "Madrid"
  }
}

###
PATCH http://localhost:5000/users/password
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "oldPassword": "1234asdf.",
  "newPassword": "1234asdf"
}

###
# Solicitar recuperación de contraseña
POST http://localhost:5000/auth/recover
Content-Type: application/json

{
  "email": "enriquerodridel@gmail.com"
}

###
# Resetear contraseña con código recibido por email
POST http://localhost:5000/auth/reset-password
Content-Type: application/json

{
  "email": "enriquerodridel@gmail.com",
  "code": "779363",
  "newPassword": "1234asdf"
}



###
POST http://localhost:5000/mail
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
    "subject": "Test",
    "text": "Test message",
    "to": "enriquerodridel@gmail.com",
    "from": "test@gmail.com"
}

###
POST http://localhost:5000/clients
Authorization: Bearer {{jwt_token}}
Content-Type: application/json

{
  "name": "ACME Servicios S.A.",
  "cif": "A12345678",
  "address": {
    "street": "Calle Falsa",
    "number": 123,
    "postal": 28080,
    "city": "Madrid",
    "province": "Madrid"
  },
  "logo": "https://example.com/logo.png"
}

###
PUT http://localhost:5000/clients/{{client_id}}
Authorization: Bearer {{jwt_token}}
Content-Type: application/json

{
  "name": "ACME Servicios y Soluciones S.L.",
  "address": {
    "street": "Calle Verdadera",
    "number": 456,
    "postal": 28081,
    "city": "Madrid",
    "province": "Madrid"
  }
}

###
GET http://localhost:5000/clients
Authorization: Bearer {{jwt_token}}

###
# Obtener un cliente por su ID
GET http://localhost:5000/clients/{{client_id}}
Authorization: Bearer {{jwt_token}}

###
# Soft delete (archivar) un cliente
DELETE http://localhost:5000/clients/{{client_id}}
Authorization: Bearer {{jwt_token}}

###
# Hard delete (borrado físico) un cliente
DELETE http://localhost:5000/clients/{{client_id}}/hard
Authorization: Bearer {{jwt_token}}

###
# Listar todos los clientes archivados (soft-deleted)
GET http://localhost:5000/clients/archived
Authorization: Bearer {{jwt_token}}

###
# Restaurar un cliente archivado (poner deleted: false)
PATCH http://localhost:5000/clients/{{client_id}}/restore
Authorization: Bearer {{jwt_token}}

###
# Crear un proyecto asociado a usuario y cliente
POST http://localhost:5000/projects
Authorization: Bearer {{jwt_token}}
Content-Type: application/json

{
  "name": "Obra Y",
  "projectCode": "Id-proyect",
  "code": "0002",
  "clientId": "{{client_id}}",
  "address": {
    "street": "Carlos II",
    "number": 22,
    "postal": 28936,
    "city": "Móstoles",
    "province": "Madrid"
  },
  "begin": "07-01-2024",
  "end": "06-04-2025",
  "notes": "no acabado"
}

###
# Actualizar un proyecto existente
PUT http://localhost:5000/projects/{{project_id}}
Authorization: Bearer {{jwt_token}}
Content-Type: application/json

{
  "name": "Obra Y actualizada",
  "notes": "actualizado"
}

###
# Mostrar todos los proyectos del usuario
GET http://localhost:5000/projects
Authorization: Bearer {{jwt_token}}

###
# Obtener un proyecto específico por ID
GET http://localhost:5000/projects/{{project_id}}
Authorization: Bearer {{jwt_token}}

###
# Archivar (soft delete) un proyecto
DELETE http://localhost:5000/projects/{{project_id}}
Authorization: Bearer {{jwt_token}}

###
# Borrar (hard delete) un proyecto
DELETE http://localhost:5000/projects/{{project_id}}/hard
Authorization: Bearer {{jwt_token}}

###
# Listar proyectos archivados (soft-deleted)
GET http://localhost:5000/projects/archived
Authorization: Bearer {{jwt_token}}

###
# Restaurar un proyecto archivado (soft deleted → activo)
PATCH http://localhost:5000/projects/{{project_id}}/restore
Authorization: Bearer {{jwt_token}}

###
# Forzar error 500 para probar notificación a Slack
GET http://localhost:5000/test-error

###
# Invitar usuario a compañía
POST http://localhost:5000/users/invite
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "email": "enriquerodriguezdelreal@gmail.com",
  "name": "invitadoName",
  "surnames": "invitadoSurname"
}

###
# Crear un albarán
POST http://localhost:5000/deliverynotes
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "userId": "{{user_id}}",
  "clientId": "{{client_id}}",
  "projectId": "{{project_id}}",
  "format": "hours",
  "hours": 7,
  "description": "my description",
  "sign": "/path/to/sign3",
  "pending": true
}

###
# Listar todos los albaranes
GET http://localhost:5000/deliverynotes
Authorization: Bearer {{jwt_token}}

###
# Obtener un albarán por ID
GET http://localhost:5000/deliverynotes/{{deliverynote_id}}
Authorization: Bearer {{jwt_token}}

###
# Actualizar un albarán (PUT)
PUT http://localhost:5000/deliverynotes/{{deliverynote_id}}
Content-Type: application/json
Authorization: Bearer {{jwt_token}}

{
  "format": "hours",
  "hours": 10,
  "description": "Actualización de descripción",
  "pending": false
}

###
# Archivar (soft delete) un albarán
DELETE http://localhost:5000/deliverynotes/{{deliverynote_id}}
Authorization: Bearer {{jwt_token}}

###
# Hard delete (borrado físico) de un albarán
DELETE http://localhost:5000/deliverynotes/{{deliverynote_id}}/hard
Authorization: Bearer {{jwt_token}}

###
# Listar albaranes archivados
GET http://localhost:5000/deliverynotes/archived
Authorization: Bearer {{jwt_token}}

###
# Restaurar un albarán archivado
PATCH http://localhost:5000/deliverynotes/{{deliverynote_id}}/restore
Authorization: Bearer {{jwt_token}}
